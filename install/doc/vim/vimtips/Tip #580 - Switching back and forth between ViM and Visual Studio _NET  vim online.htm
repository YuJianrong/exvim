<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0050)http://vim.sourceforge.net/tips/tip.php?tip_id=580 -->
<HTML><HEAD><TITLE>Tip #580 - Switching back and forth between ViM and Visual Studio .NET : vim online</TITLE><LINK 
href="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/style.css" 
type=text/css rel=Stylesheet>
<META http-equiv=Content-Type content="text/html; charset=ISO-8859-1">
<META 
content="Vim, Vi IMproved, text editor, home, documentation, tips, scripts, news" 
name=KEYWORDS><LINK href="/images/vim_shortcut.ico" type=image/x-icon 
rel="shortcut icon">
<META content="MSHTML 6.00.2900.2963" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff leftMargin=0 topMargin=0 marginwidth="0" marginheight="0"><!-- HEADER, SPONSOR IMAGE, VIM IMAGE AND BOOK AD -->
<TABLE borderColor=red cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=lightbg colSpan=4><IMG height=5 alt="" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
      width=1></TD></TR>
  <TR>
    <TD class=lightbg>&nbsp;&nbsp;&nbsp;</TD>
    <TD class=lightbg align=left><A 
      href="http://vim.sourceforge.net/sponsor/index.php"><IMG 
      alt="sponsor Vim development" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/sponsorvim.gif" 
      border=0></A></TD>
    <TD class=lightbg align=middle><A 
      href="http://vim.sourceforge.net/index.php"><IMG alt="Vim logo" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/vim_header.gif" 
      border=0></A></TD>
    <TD class=lightbg align=right><A 
      href="http://iccf-holland.org/click5.html"><IMG alt="Vim Book Ad" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/buyhelplearn.gif" 
      border=0></A></TD></TR>
  <TR>
    <TD class=lightbg colSpan=4><IMG height=5 alt="" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
      width=1></TD></TR>
  <TR>
    <TD class=darkbg colSpan=4><IMG height=10 alt="" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
      width=1></TD></TR></TBODY></TABLE><!-- THE PAGE BODY: BETWEEN HEADER AND FOOTER -->
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <COLGROUP>
  <COL width=180>
  <COL width=1>
  <TBODY>
  <TR vAlign=top>
    <TD class=sidebar>
      <TABLE cellSpacing=0 cellPadding=4 width=180 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=sidebar><!-- INCLUDE THE PAGE NAVIGATION -->
            <TABLE borderColor=red cellSpacing=0 cellPadding=0 width="100%" 
            border=0>
              <TBODY>
              <TR>
                <TD><SMALL>not logged in (<A 
                  href="http://vim.sourceforge.net/login.php">login</A>)</SMALL></TD></TR>
              <TR>
                <TD><IMG height=1 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  width=1 border=0></TD></TR>
              <TR>
                <TD class=darkbg><IMG height=3 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  border=0></TD></TR>
              <TR>
                <TD><IMG height=2 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  width=1 border=0></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/index.php">Home</A></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/search.php">Search</A></TD></TR>
              <TR>
                <TD><IMG height=7 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  width=1 border=0></TD></TR>
              <TR>
                <TD class=checker><IMG height=1 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  border=0></TD></TR>
              <TR>
                <TD><IMG height=7 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  width=1 border=0></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/about.php">About 
Vim</A></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/community.php">Community</A></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/news/news.php">News</A></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/sponsor/index.php">Sponsoring</A></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/trivia.php">Trivia</A></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/docs.php">Documentation</A></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/download.php">Download</A></TD></TR>
              <TR>
                <TD><IMG height=7 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  width=1 border=0></TD></TR>
              <TR>
                <TD class=checker><IMG height=1 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  border=0></TD></TR>
              <TR>
                <TD><IMG height=7 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  width=1 border=0></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/scripts/index.php">Scripts</A></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/tips/index.php">Tips</A></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/account/index.php">My 
                  Account</A></TD></TR>
              <TR>
                <TD><IMG height=7 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  width=1 border=0></TD></TR>
              <TR>
                <TD class=checker><IMG height=1 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  border=0></TD></TR>
              <TR>
                <TD><IMG height=7 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  width=1 border=0></TD></TR>
              <TR>
                <TD class=sidebarheader><A 
                  href="http://vim.sourceforge.net/huh.php">Site 
              Help</A></TD></TR></TBODY></TABLE>
            <TABLE cellSpacing=0 cellPadding=0 width=172 border=0>
              <TBODY>
              <TR>
                <TD><IMG height=8 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  width=1 border=0></TD></TR>
              <TR>
                <TD class=darkbg><IMG height=3 alt="" 
                  src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
                  width=1></TD></TR></TBODY></TABLE><BR><!-- INCLUDE THE PAGE SIDEBAR TEXT -->&nbsp; 
          </TD></TR></TBODY></TABLE></TD>
    <TD class=darkbg><IMG height=1 alt="" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
      width=1 border=0><BR></TD>
    <TD>
      <TABLE borderColor=red cellSpacing=0 cellPadding=10 width="100%" 
        border=0><TBODY>
        <TR>
          <TD vAlign=top>
            <H1><IMG alt=intermediate 
            src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/intermediate.gif">&nbsp;Tip 
            #580: Switching back and forth between ViM and Visual Studio 
            .NET</H1><!-- karma table -->
            <TABLE borderColor=#000066 cellSpacing=0 cellPadding=4 border=1>
              <TBODY>
              <TR>
                <TD class=lightbg><B>&nbsp;tip karma&nbsp;</B></TD>
                <TD>&nbsp;Rating <B>73/27</B>, Viewed by 8190&nbsp; 
              </TD></TR></TBODY></TABLE><BR>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD class=prompt>created:</TD>
                <TD>&nbsp;</TD>
                <TD>October 6, 2003 10:43</TD>
                <TD>&nbsp;&nbsp;&nbsp;&nbsp;</TD>
                <TD class=prompt>complexity:</TD>
                <TD>&nbsp;</TD>
                <TD>intermediate</TD></TR>
              <TR>
                <TD class=prompt>author:</TD>
                <TD>&nbsp;</TD>
                <TD>Francois Leblanc</TD>
                <TD>&nbsp;&nbsp;&nbsp;&nbsp;</TD>
                <TD class=prompt>as of Vim:</TD>
                <TD>&nbsp;</TD>
                <TD>6.0</TD></TR></TBODY></TABLE>
            <P><CODE>This tip is for when you work on a devstudio project and 
            need the debugger heavily and/or can't stay in ViM all the time. But 
            when it comes time to make changes you want to do them in ViM and 
            don't want to relocate the file and line number. <BR><BR>After you 
            have made the change and perhaps opened another file or navigated 
            your way to a new section of the code you want to switch back to 
            devstudio at the spot you were in ViM. It may be because you want to 
            set a breakpoint or any reason. <BR><BR>The easy part: <BR>Launching 
            ViM from DevStudio.NET is easy. <BR><BR>From the DevStudio menu item 
            Tools|External Tools...&nbsp;&nbsp;add a new entry where: <BR>The 
            "Command Line" field is set to the path of the ViM executable 
            <BR>The "Arguments" field contains: --servername gmain 
            --remote-silent +$(CurLine) +"normal zz" $(ItemPath) <BR>The 
            "Initial Directory" may optionally contain: $(ItemDir) <BR><BR>This 
            will start a ViM session or connect to an already existing one 
            (--remote-silent) named gmain (--servername gmain). This will use 
            only one instance of ViM for all devstudio editing. It will open the 
            file specified by $(ItemPath) and set the cursor pos to $(CurLine). 
            It will also execute the normal command zz to center the cursor. 
            <BR><BR>You can then create a keyboard shorcut to map to this tool 
            (Tools|Options||Environment|Keyboard, select Tools.ExternalCommandX) 
            and you will be able to switch to ViM quickly. <BR><BR><BR>The hard 
            part: <BR>Opening a file in an existing DevStudio.NET instance is a 
            pain and setting the cursor to a line number is even more so. 
            <BR><BR>DevStudio cannot be controlled by the command line. To open 
            a file in an existing instance a DDE call must be initiated. Its an 
            old and obsolete technology called Dynamic Data Exchange used for 
            interprocess communication. When you click on a .cpp file in the 
            Windows Explorer it calls devenv.exe with the /DDE switch (its 
            undocumented) and sends it an Open DDE command. You can see it for 
            yourself if you look at the file type mapping of .cpp in the Windows 
            Explorer (if you haven't already changed them to open ViM :-)). The 
            Explorer shell is DDE enabled but I found no way to send DDE from 
            the command line (I didn't really look for it either ;-)). So I 
            wrote a small C++ console app from the code I got from an Experts 
            Exchange question. I formatted the code, renamed references from 
            DevStudio to DevEnv and put it in a project. <BR><BR>Setting the 
            line number is a different problem. I wrote a Perl script using the 
            Win32::GuiTest module. This module allows interacting with the 
            Windows GUI and provides a very useful function called SendKeys. The 
            script finds the Visual C++ window (if you are using a different 
            language change the script) and sends it: a CTRL-G, the current line 
            number as specified on the command line and ENTER. <BR><BR>It is 
            integrated in ViM by a function (in _vimrc) that gets the current 
            file name and line number and silently executes the script: 
            <BR>function! DevEnvDDE() <BR>let cmd = '!devenvdden.pl %:p ' . 
            line(".") <BR>silent execute cmd <BR>endfunction <BR><BR>All that is 
            left is to map the function to a key. <BR><BR><BR>You can get the 
            source files for the Perl script and DDE project at <A 
            href="http://dunderxiii.tripod.com/vimtips/devenvdde.zip" 
            target=_blank>http://dunderxiii.tripod.com/vimtips/devenvdde.zip</A> 
            <BR>The original DDE code was taken at <A 
            href="http://www.experts-exchange.com/Programming/Programming_Platforms/Win_Prog/Q_20489782.html" 
            target=_blank>http://www.experts-exchange.com/Programming/Programming_Platforms/Win_Prog/Q_20489782.html</A> 
            <BR>Win32::GUITest is located at <A 
            href="http://groups.yahoo.com/group/perlguitest/" 
            target=_blank>http://groups.yahoo.com/group/perlguitest/</A></CODE></P><!-- rating table -->
            <FORM name=rating><INPUT type=hidden value=580 name=tip_id> 
            <TABLE borderColor=#000066 cellSpacing=0 cellPadding=4 border=1>
              <TBODY>
              <TR>
                <TD class=lightbg><B>&nbsp;rate this tip&nbsp;</B></TD>
                <TD vAlign=center><INPUT type=radio value=life_changing 
                  name=rating>Life Changing <INPUT type=radio value=helpful 
                  name=rating>Helpful <INPUT type=radio value=unfulfilling 
                  name=rating>Unfulfilling&nbsp; <INPUT type=submit value=rate> 
                </TD></TR></TBODY></TABLE></FORM>
            <P><SMALL><A 
            href="http://vim.sourceforge.net/tips/tip.php?tip_id=579">&lt;&lt;Cut&amp;Paste 
            without too much newlines, eg. into WORD</A> | <A 
            href="http://vim.sourceforge.net/tips/tip.php?tip_id=581">Using vim 
            to view source and edit textarea in mozilla/firebird &gt;&gt;</A> 
            </SMALL><BR><BR>
            <H1>Additional Notes</H1>
            <FORM action=add_tip_note.php method=get><INPUT type=hidden 
            value=580 name=tip_id> 
            <TABLE cellSpacing=4 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR>
                <TD class=lightbg>mosh@cs.albany.edu, <FONT size=-1>October 6, 
                  2003 18:46 </FONT></TD></TR>
              <TR>
                <TD><TT>I have the script send-to-msdev.sh, that uses Perl + 
                  Win32::Ole <BR>to open files in VC. You can even set 
                  breakpoints from perl, <BR>this script has pointers to MSDN 
                  documentation. <BR><BR>&nbsp;&nbsp;<A 
                  href="http://www.cs.albany.edu/~mosh/Perl/send-to-msdev.ksh" 
                  target=_blank>http://www.cs.albany.edu/~mosh/Perl/send-to-msdev.ksh</A> 
                  <BR><BR>Caveats: All win32 perl to be buggy in some respect, 
                  <BR>but active perl55 is the only one that can talk to vc. 
                  <BR>Very few commands in msdev can be automated, some dont 
                  <BR>even have a name, you just have to click&nbsp;&nbsp;to get 
                  to them! <BR><BR>- Mohsin <BR><BR>"Her bed is India; there she 
                  lies, a pearl" - Troillus and Cressida 1.1, WS. <BR><BR># Guts 
                  of the OLE messages that work (part of sh script) 
                  <BR><BR>d:/perl/perl_55x/bin/perl.exe -e ' 
                  <BR>push(@INC,"d:/perl/perl_55x/lib/site"); <BR>require 
                  Win32::OLE; <BR>$app = 
                  Win32::OLE-&gt;GetActiveObject("MSDev.Application"); <BR>$app 
                  = Win32::OLE-&gt;new("MSDEV.APPLICATION") if ! defined $app; 
                  <BR>die "Cant open MsDev.\n" unless $app; 
                  <BR>$app-&gt;{"WindowState"} = 1 if $app-&gt;{"WindowState"} 
                  == 2; <BR>$app-&gt;{"Visible"}=1; <BR>$app-&gt;{"Active"}=1; 
                  <BR><BR>$file = 
                  $app-&gt;{"Documents"}-&gt;Open("'$VIEWFILE'"); <BR>die "Cant 
                  open file='$VIEWFILE' in msdev.\n" unless $file; <BR>print( 
                  $app-&gt;FullName()," ",$file-&gt;FullName()," 
                  type=",$file-&gt;Type(),".\n" ); 
                  <BR>print("PWD=",$app-&gt;CurrentDirectory(),".\n"); 
                  <BR><BR>$file-&gt;Selection()-&gt;GotoLine("'$GOTOLINE'") if 
                  $ENV{"GOTOLINE"}; <BR># dsMatchWord is in 
                  vc/include/objmodel/textdefs.h 
                  <BR>$file-&gt;Selection()-&gt;FindText($ENV{"FINDTEXT"},2) if 
                  $ENV{"FINDTEXT"}; <BR>$file-&gt;Selection()-&gt;Selectline(); 
                  # highlight it. <BR><BR>exit 0; <BR>'</TT></TD></TR>
              <TR>
                <TD class=lightbg>dunderxiii@hotmail.com, <FONT 
                  size=-1>October 10, 2003 7:39 </FONT></TD></TR>
              <TR>
                <TD><TT>I udated the DevEnvDDE program to connect to Visual 
                  Studio .NET 2003. The code now supports an extra command line 
                  parameter that specifies the visual studio instance to open 
                  the file in (VS6, VSNET or VSNET2003). Simply download the new 
                  sources (same link). <BR><BR>Note: it now defaults to Visual 
                  Studio .NET 2003 instead of Visual Studio .NET</TT></TD></TR>
              <TR>
                <TD class=lightbg><B>Anonymous</B>, <FONT size=-1>October 22, 
                  2003 13:47 </FONT></TD></TR>
              <TR>
                <TD><TT>Thanks for this! <BR><BR>Just a small note regarding 
                  the perl script - you don't say which version of 
                  Win32::GUITest you are using but I found that I had to change 
                  WaitWindow to FindWindowLike to get the script 
                  working.&nbsp;&nbsp;WaitWindow must be deprecated or 
                  something.</TT></TD></TR>
              <TR>
                <TD class=lightbg>orthober@msoe.edu, <FONT size=-1>January 29, 
                  2004 8:30 </FONT></TD></TR>
              <TR>
                <TD><TT>Just to let you know, to open a file with Visual 
                  Studio (At least the current versions) you simple can put the 
                  file name as an arument to the command line.&nbsp;&nbsp; 
                  <BR><BR>Example: <BR><BR>"C:\Program Files\Microsoft Visual 
                  Studio .NET 2003\Common7\IDE\devenv.exe" 
                  "BE-NotInDirectory\main.cpp" "CC-late\main.c <BR>pp" "DO\Lab 
                  5.cpp" "MG\Lab5.cpp" "NathanK\main.cpp" "NH\func.h" 
                  "NH\func.cpp" "NH\main.cpp" "NM-late\main.cpp" <BR><BR>Would 
                  open all of these files. <BR><BR>What I am looking for is a 
                  way to tell VS to Auto Print these files.&nbsp;&nbsp;I have 
                  also made a program that will SENDKEYS to VS to print these, 
                  but I would like a better way. <BR><BR>Thanks <BR>Jeff 
                O</TT></TD></TR>
              <TR>
                <TD class=lightbg>rdparker@butlermfg.com, <FONT size=-1>March 
                  24, 2004 9:16 </FONT></TD></TR>
              <TR>
                <TD><TT>For Visual Studio 6.0 replace ItemPath and ItemDir 
                  with FilePath and FileDir, as follows: 
                  <BR><BR>Arguments:&nbsp;&nbsp;--servername gmain 
                  --remote-silent +$(CurLine) +"normal zz" "$(FilePath)" 
                  <BR>(Optional) Initial directory: $(FileDir)</TT></TD></TR>
              <TR>
                <TD class=lightbg>Anonymous, <FONT size=-1>April 23, 2004 5:00 
                  </FONT></TD></TR>
              <TR>
                <TD><TT>An alternate distribution of Win32::GuiTest can be 
                  found at <A 
                  href="https://sourceforge.net/projects/winguitest/" 
                  target=_blank>https://sourceforge.net/projects/winguitest/</A> 
                  <BR><BR>Note: WaitWindow was a recent addition. 
                  <BR><BR><BR></TT></TD></TR>
              <TR>
                <TD class=lightbg>faceprint@faceprint.com, <FONT 
                  size=-1>September 1, 2004 10:01 </FONT></TD></TR>
              <TR>
                <TD><TT>To get the current column as well as the current line: 
                  <BR>--remote-silent +"call cursor($(CurLine),$(CurCol))" 
                  +"normal zz" $(ItemPath)</TT></TD></TR>
              <TR>
                <TD class=lightbg>Da5id, <FONT size=-1>April 9, 2005 14:59 
                  </FONT></TD></TR>
              <TR>
                <TD><TT>::Nice::&nbsp;&nbsp;This is a great hack. I had to 
                  make the same change to <BR>devenvdden.pl described by a 
                  previous poster, namely: change the two <BR>occurrences of 
                  'WaitForWindow' to 'FindWindowLike'.&nbsp;&nbsp;(It threw me 
                  at <BR>first that my Mozilla Firefox window kept coming up; I 
                  was led to this <BR>post by googling for 'vim "visual studio 
                  .net"', which happens to <BR>match--d'oh!) <BR><BR>I also got 
                  a little confused when trying to exercise the individual 
                  <BR>pieces one at a time to make sure I understood how each 
                  worked. Turns <BR>out you have to use *absolute* paths. But 
                  once I got it working--man, <BR>what a nice little 
                  hack.&nbsp;&nbsp;Thanks! :-D <BR></TT></TD></TR>
              <TR>
                <TD class=lightbg>litewerk@gmail.com, <FONT size=-1>October 6, 
                  2005 23:40 </FONT></TD></TR>
              <TR>
                <TD><TT>Here's some code to add to DevEnvDDE.cpp to make it do 
                  the GoToLine thing from C++, so you can just run this thing 
                  from the command line and not have to do the scripting 
                  afterword.&nbsp;&nbsp;You might have to add some headers to 
                  stdafx (atlstr.h, afxwin.h) and add MFC and possible ATL 
                  support to the project... <BR><BR>void PeekAndYield() <BR>{ 
                  <BR>MSG Msg; <BR>while( PeekMessage( &amp;Msg, NULL, 0, 0, 
                  PM_REMOVE ) ) { <BR>TranslateMessage(&amp;Msg); 
                  <BR>DispatchMessage(&amp;Msg); <BR>} <BR>} <BR><BR>class 
                  Find_window { <BR>public: <BR>Find_window( std::string 
                  find_str_ ) : find_str( find_str_ ), hwnd( NULL ) {} 
                  <BR>std::string find_str; <BR>HWND hwnd; <BR>}; <BR><BR>BOOL 
                  CALLBACK EnumWindowsProc( HWND hwnd, LPARAM lParam ) <BR>{ 
                  <BR>Find_window* fw = (Find_window*) lParam; <BR>CWnd cwnd; 
                  <BR>cwnd.Attach( hwnd ); <BR>CString cstr; 
                  <BR>cwnd.GetWindowText( cstr ); <BR>cwnd.Detach(); 
                  <BR>std::string str( cstr ); <BR>typedef std::string::iterator 
                  str_iterator; <BR>std::string find_str = "Microsoft Visual 
                  C++"; <BR>std::pair&lt;str_iterator,str_iterator&gt; nxt = 
                  nbs::find_section( str.begin(), str.end(), find_str.begin(), 
                  find_str.end() ); <BR>if( nxt.first == str.end() ) { 
                  <BR>return TRUE; <BR>} else { <BR>fw-&gt;hwnd = hwnd; 
                  <BR>return FALSE; <BR>} <BR>} <BR><BR><BR>void 
                  MSDEV_OpenFile(char* pszFileName, int line_number, 
                  EVisualStudioType vsType ) <BR>{ <BR>//... <BR>//Lots of code, 
                  leave it the same... <BR>//... <BR>if( line_number &lt; 0 ) 
                  line_number = -line_number; <BR>if( line_number &gt; 0 ) { 
                  <BR>Find_window fnd( "Microsoft Visual C++" ); 
                  <BR>EnumWindows( EnumWindowsProc, (LPARAM)&amp;fnd ); <BR>if( 
                  fnd.hwnd ) { <BR>::SetForegroundWindow( fnd.hwnd ); 
                  <BR>PeekAndYield(); <BR>keybd_event( VK_CONTROL, 0, 0, 0 ); 
                  <BR>keybd_event( 'G', 0, 0, 0 ); <BR>PeekAndYield(); 
                  <BR>keybd_event( 'G', 0, KEYEVENTF_KEYUP, 0 ); 
                  <BR>keybd_event( VK_CONTROL, 0, KEYEVENTF_KEYUP, 0 ); 
                  <BR>PeekAndYield(); <BR>std::string lstr = nbs::to_str( 
                  line_number ); <BR>for( size_t i = 0; i &lt; lstr.size(); ++i 
                  ) { <BR>keybd_event( lstr[i], 0, 0, 0 ); <BR>keybd_event( 
                  lstr[i], 0, KEYEVENTF_KEYUP, 0 ); <BR>} <BR>PeekAndYield(); 
                  <BR>keybd_event( VK_RETURN, 0, 0, 0 ); <BR>keybd_event( 
                  VK_RETURN, 0, KEYEVENTF_KEYUP, 0 ); <BR>PeekAndYield(); <BR>} 
                  <BR>} <BR>} <BR><BR><BR>int _tmain(int argc, _TCHAR* argv[]) 
                  <BR>{ <BR>if( argc &lt;= 1 ){ <BR>usage(); <BR>return 1; <BR>} 
                  <BR>int line_number = 0; <BR><BR>if( argc &gt; 2 ){ 
                  <BR>line_number = atoi( argv[2] ); <BR>} 
                  <BR><BR>EVisualStudioType vsType = eVSNET2003; <BR>if( argc 
                  &gt; 3 ){ <BR>if(stricmp(argv[3], "VS6") == 0){ <BR>vsType = 
                  eVS6; <BR>}else if(stricmp(argv[3], "VSNET") == 0){ <BR>vsType 
                  = eVSNET; <BR>}else if(stricmp(argv[3], "VSNET2003") == 0){ 
                  <BR>vsType = eVSNET2003; <BR>}else{ <BR>usage(); <BR>return 1; 
                  <BR>} <BR>} <BR><BR>MSDEV_OpenFile(argv[1], line_number, 
                  vsType); <BR>return 0; <BR>} <BR><BR></TT></TD></TR>
              <TR>
                <TD class=lightbg>litewerk@gmail.com, <FONT size=-1>October 6, 
                  2005 23:45 </FONT></TD></TR>
              <TR>
                <TD><TT>I forgot the code for find_section... 
                  <BR><BR><BR>template &lt;class T1,class T2&gt; 
                  <BR>std::pair&lt;T1,T1&gt; find_section( T1 first, T1 last, T2 
                  first2, T2 last2 ) <BR>{ <BR>&nbsp;&nbsp; 
                  std::pair&lt;T1,T1&gt; result( last, last ); 
                  <BR><BR>&nbsp;&nbsp; if (first2 != last2) <BR>&nbsp;&nbsp; { 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first = std::find( 
                  first, last, *first2 ); 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (first != last) 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T1 temp = 
                  first; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                  ++temp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                  T2 temp2 = first2; 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ++temp2; 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while ( 
                  (temp != last) &amp;&amp; (temp2 != last2) &amp;&amp; (*temp 
                  == *temp2) ) 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp++; 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp2++; 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (temp2 
                  == last2) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                  { 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.first 
                  = first; 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.second 
                  = temp; 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break; 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                  }&nbsp;&nbsp;&nbsp;&nbsp; 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ++first; 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; first = std::find( 
                  first, last, *first2 ); 
                  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <BR>&nbsp;&nbsp; } 
                  <BR><BR>&nbsp;&nbsp; return result; <BR>} <BR><BR>and 
                  to_str... <BR><BR>std::string to_str( int i ) <BR>{ <BR>char 
                  buffer[34]; <BR>return itoa( i, buffer, 10 ); <BR>}</TT></TD></TR>
              <TR>
                <TD class=lightbg>litewerk@gmail.com, <FONT size=-1>October 
                  10, 2005 18:10 </FONT></TD></TR>
              <TR>
                <TD><TT>I am dumb.&nbsp;&nbsp;No need for that find_section 
                  junk.&nbsp;&nbsp;Just do this... <BR><BR>BOOL CALLBACK 
                  EnumWindowsProc( HWND hwnd, LPARAM lParam ) <BR>{ 
                  <BR>Find_window* fw = (Find_window*) lParam; <BR>CWnd cwnd; 
                  <BR>cwnd.Attach( hwnd ); <BR>CString cstr; 
                  <BR>cwnd.GetWindowText( cstr ); <BR>cwnd.Detach(); 
                  <BR>std::string str( cstr ); <BR>if( str.find( "Microsoft 
                  Visual C++" ) != std::string::npos ) { <BR>fw-&gt;hwnd = hwnd; 
                  <BR>return FALSE; <BR>} else { <BR>return TRUE; <BR>} <BR>} 
                  <BR><BR>If anybody ever actually reads this, email me or 
                  something so I know I wasn't posting all this junk in 
                  vain.&nbsp;&nbsp;Also, the reason I wanted it all in one exe 
                  was so I could use it with WinDiff, which doesn't let you run 
                  scripts.</TT></TD></TR>
              <TR>
                <TD><INPUT type=submit value="Add Note" name="Add Note"> 
              </TD></TR></TBODY></TABLE></FORM><!-- finish off the framework --></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><!-- END OF THE PAGE BODY: BETWEEN HEADER AND FOOTER -->
<TABLE borderColor=red cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD colSpan=4><IMG height=5 alt="" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
      width=1></TD></TR>
  <TR>
    <TD bgColor=#000000 colSpan=4><IMG height=2 alt="" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
      width=1></TD></TR>
  <TR>
    <TD colSpan=4><IMG height=5 alt="" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
      width=1></TD></TR>
  <TR>
    <TD><IMG height=1 alt="" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
      width=5></TD>
    <TD vAlign=top align=left><SMALL>If you have questions or remarks about 
      this site, visit the <A href="http://vimonline.sf.net/">vimonline 
      development</A> pages. Please use this site responsibly. <BR>Questions 
      about <A href="http://www.vim.org/about.php">Vim</A> should go to 
      vim@vim.org after searching <A 
      href="http://groups.yahoo.com/group/vim">the archive</A>. Help Bram <A 
      href="http://iccf-holland.org/">help Uganda</A>. </SMALL>&nbsp; &nbsp; <!-- Start of StatCounter Code -->
      <SCRIPT language=javascript type=text/javascript>
	var sc_project=1417324; 
	var sc_invisible=1; 
	var sc_partition=11; 
	var sc_security="d41633bc"; 
	</SCRIPT>

      <SCRIPT language=javascript 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/counter.js" 
      type=text/javascript></SCRIPT>
      <NOSCRIPT><A href="http://www.statcounter.com/" target=_blank><IMG 
      alt="free tracking" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/counter.png" 
      border=0></A> </NOSCRIPT><!-- End of StatCounter Code --><SMALL><A 
      href="http://my.statcounter.com/project/standard/stats.php?project_id=1417324&amp;guest=1">stats</A> 
      </SMALL></TD>
    <TD vAlign=top align=right><A href="http://www.webconceptgroup.net/"><IMG 
      height=30 alt="Sponsored by Web Concept Group Inc." 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/logo_sponsor_wcg.jpg" 
      width=131 border=0></A> <A href="http://sourceforge.net/"><IMG height=31 
      alt="SourceForge.net Logo" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/sflogo.png" 
      width=88 border=0></A> </TD>
    <TD><IMG height=1 alt="" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
      width=5></TD></TR>
  <TR>
    <TD colSpan=4><IMG height=5 alt="" 
      src="Tip #580 - Switching back and forth between ViM and Visual Studio _NET  vim online_files/spacer.gif" 
      width=1></TD></TR></TBODY></TABLE></BODY></HTML>
